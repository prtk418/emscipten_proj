<textarea id="output_area" style="width:100%; height:50%"></textarea>

<!-- Button for triggering c++ multiply method  -->
<button onclick="multiplyInCpp(event)" style="width:100%; height:50%">Show Result</button>
<script>

  function output(text) {

    document.getElementById("output_area").append(text + "\n\n");

  }

  //on load promise resolves no
  let initialized = new Promise((resolve,reject) => {
    resolve('no');
  });  

  var Module = {

    'print': function (text) {

      output("print\n" + text);

    },

    'printErr': function (text) {

      output("printErr\n" + text);

    },

    'onRuntimeInitialized': async function() {

      //after initialization promise resolves done
      initialized = new Promise((resolve,reject) => {
        resolve('done');
      });
      
      const button = document.getElementsByTagName('button')[0];
      button.click();

  }

  };

  async function multiplyInCpp(event) {

    let x = event.clientX;
    let y = event.clientY;

    let is_initialized = await initialized;
    
    // if Module is initialized (done is resolved) then only invoke Module.ccall()
    if(is_initialized === 'done') {

      let result = new Promise(resolve => {

        output(Module.ccall('multiply', // name of C++ function 
                   'number', // return type
                   ['number','number'], // argument types
                   [x, y])); // arguments 

      });

    }

  }

</script>

<script src="multiply.js"></script>
<script src="multiply_in.js"></script>